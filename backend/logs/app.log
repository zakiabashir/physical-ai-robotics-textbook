2025-12-07 20:23:37 | INFO     | logging:callHandlers:1762 - Starting up Physical AI Textbook API...
2025-12-07 20:23:37 | INFO     | logging:callHandlers:1762 - Database tables created successfully
2025-12-07 20:23:37 | INFO     | logging:callHandlers:1762 - Database initialized
2025-12-07 20:36:14 | INFO     | logging:callHandlers:1762 - Starting up Physical AI Textbook API...
2025-12-07 20:36:14 | INFO     | logging:callHandlers:1762 - BEGIN (implicit)
2025-12-07 20:36:14 | INFO     | logging:callHandlers:1762 - Database tables created successfully
2025-12-07 20:36:14 | INFO     | logging:callHandlers:1762 - COMMIT
2025-12-07 20:36:14 | INFO     | logging:callHandlers:1762 - Database initialized
2025-12-07 20:37:48 | INFO     | logging:callHandlers:1762 - Starting up Physical AI Textbook API...
2025-12-07 20:37:48 | INFO     | logging:callHandlers:1762 - BEGIN (implicit)
2025-12-07 20:37:48 | INFO     | logging:callHandlers:1762 - Database tables created successfully
2025-12-07 20:37:48 | INFO     | logging:callHandlers:1762 - COMMIT
2025-12-07 20:37:48 | INFO     | logging:callHandlers:1762 - Database initialized
2025-12-07 20:37:48 | INFO     | logging:callHandlers:1762 - Shutting down Physical AI Textbook API...
2025-12-07 21:04:07 | INFO     | logging:callHandlers:1762 - Starting up Physical AI Textbook API...
2025-12-07 21:04:07 | INFO     | logging:callHandlers:1762 - BEGIN (implicit)
2025-12-07 21:04:07 | INFO     | logging:callHandlers:1762 - Database tables created successfully
2025-12-07 21:04:07 | INFO     | logging:callHandlers:1762 - COMMIT
2025-12-07 21:04:07 | INFO     | logging:callHandlers:1762 - Database initialized
2025-12-08 08:15:34 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://testserver/ "HTTP/1.1 200 OK"
2025-12-08 08:15:34 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-12-08 08:15:34 | INFO     | logging:callHandlers:1762 - Initializing PhysicalAI Chatbot...
2025-12-08 08:15:35 | ERROR    | logging:callHandlers:1762 - Unexpected error at POST http://testserver/api/v1/chat/: name '_chatbot' is not defined
Traceback (most recent call last):
  File "D:\physical_AI_book_hacka\backend\app\middleware\error_handler.py", line 25, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\starlette\middleware\base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\fastapi\routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\fastapi\routing.py", line 106, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\fastapi\routing.py", line 420, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\User\AppData\Local\Programs\Python\Python312\Lib\site-packages\fastapi\dependencies\utils.py", line 667, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\physical_AI_book_hacka\backend\app\core\dependencies.py", line 23, in get_chatbot
    await _chatbot.initialize_with_content()
          ^^^^^^^^
NameError: name '_chatbot' is not defined. Did you mean: 'get_chatbot'?

2025-12-08 08:15:35 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://testserver/api/v1/chat/ "HTTP/1.1 500 Internal Server Error"
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - HTTP Request: POST https://api.cohere.com/v1/embed "HTTP/1.1 400 Bad Request"
2025-12-08 08:15:36 | ERROR    | logging:callHandlers:1762 - Error generating embedding: headers: {'access-control-expose-headers': 'X-Debug-Trace-ID', 'cache-control': 'no-cache, no-store, no-transform, must-revalidate, private, max-age=0', 'content-encoding': 'gzip', 'content-type': 'application/json', 'expires': 'Thu, 01 Jan 1970 00:00:00 GMT', 'pragma': 'no-cache', 'vary': 'Origin,Accept-Encoding', 'x-accel-expires': '0', 'x-debug-trace-id': '5b8f11373d31aebd294fa6e7916b89a3', 'x-endpoint-monthly-call-limit': '1000', 'x-trial-endpoint-call-limit': '100', 'x-trial-endpoint-call-remaining': '99', 'date': 'Mon, 08 Dec 2025 03:15:36 GMT', 'x-envoy-upstream-service-time': '21', 'server': 'envoy', 'via': '1.1 google', 'alt-svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000', 'transfer-encoding': 'chunked'}, status_code: 400, body: {'id': 'fb9d4a8a-5d45-4672-ac2a-e96a8e8517b3', 'message': 'invalid request: valid input_type must be provided with the provided model'}
2025-12-08 08:15:36 | ERROR    | logging:callHandlers:1762 - Error retrieving documents: headers: {'access-control-expose-headers': 'X-Debug-Trace-ID', 'cache-control': 'no-cache, no-store, no-transform, must-revalidate, private, max-age=0', 'content-encoding': 'gzip', 'content-type': 'application/json', 'expires': 'Thu, 01 Jan 1970 00:00:00 GMT', 'pragma': 'no-cache', 'vary': 'Origin,Accept-Encoding', 'x-accel-expires': '0', 'x-debug-trace-id': '5b8f11373d31aebd294fa6e7916b89a3', 'x-endpoint-monthly-call-limit': '1000', 'x-trial-endpoint-call-limit': '100', 'x-trial-endpoint-call-remaining': '99', 'date': 'Mon, 08 Dec 2025 03:15:36 GMT', 'x-envoy-upstream-service-time': '21', 'server': 'envoy', 'via': '1.1 google', 'alt-svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000', 'transfer-encoding': 'chunked'}, status_code: 400, body: {'id': 'fb9d4a8a-5d45-4672-ac2a-e96a8e8517b3', 'message': 'invalid request: valid input_type must be provided with the provided model'}
2025-12-08 08:15:36 | ERROR    | logging:callHandlers:1762 - RAG retrieval failed: headers: {'access-control-expose-headers': 'X-Debug-Trace-ID', 'cache-control': 'no-cache, no-store, no-transform, must-revalidate, private, max-age=0', 'content-encoding': 'gzip', 'content-type': 'application/json', 'expires': 'Thu, 01 Jan 1970 00:00:00 GMT', 'pragma': 'no-cache', 'vary': 'Origin,Accept-Encoding', 'x-accel-expires': '0', 'x-debug-trace-id': '5b8f11373d31aebd294fa6e7916b89a3', 'x-endpoint-monthly-call-limit': '1000', 'x-trial-endpoint-call-limit': '100', 'x-trial-endpoint-call-remaining': '99', 'date': 'Mon, 08 Dec 2025 03:15:36 GMT', 'x-envoy-upstream-service-time': '21', 'server': 'envoy', 'via': '1.1 google', 'alt-svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000', 'transfer-encoding': 'chunked'}, status_code: 400, body: {'id': 'fb9d4a8a-5d45-4672-ac2a-e96a8e8517b3', 'message': 'invalid request: valid input_type must be provided with the provided model'}
2025-12-08 08:15:36 | ERROR    | logging:callHandlers:1762 - Generation failed: GeminiClient.chat_completion() got an unexpected keyword argument 'max_tokens'
2025-12-08 08:15:36 | ERROR    | logging:callHandlers:1762 - Error processing message: GeminiClient.chat_completion() got an unexpected keyword argument 'max_tokens'
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://testserver/api/v1/chat/ "HTTP/1.1 200 OK"
2025-12-08 08:15:36 | WARNING  | logging:callHandlers:1762 - Validation error at POST http://testserver/api/v1/chat/: 1 validation error:
  {'type': 'string_too_short', 'loc': ('body', 'message'), 'msg': 'String should have at least 1 character', 'input': '', 'ctx': {'min_length': 1}}

  File "D:\physical_AI_book_hacka\backend\app\routers\chat.py", line 18, in chat
    POST /api/v1/chat/
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://testserver/api/v1/chat/ "HTTP/1.1 422 Unprocessable Entity"
2025-12-08 08:15:36 | WARNING  | logging:callHandlers:1762 - Validation error at POST http://testserver/api/v1/chat/: 1 validation error:
  {'type': 'missing', 'loc': ('body', 'message'), 'msg': 'Field required', 'input': {}}

  File "D:\physical_AI_book_hacka\backend\app\routers\chat.py", line 18, in chat
    POST /api/v1/chat/
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://testserver/api/v1/chat/ "HTTP/1.1 422 Unprocessable Entity"
2025-12-08 08:15:36 | WARNING  | logging:callHandlers:1762 - Validation error at POST http://testserver/api/v1/chat/: 1 validation error:
  {'type': 'string_too_long', 'loc': ('body', 'message'), 'msg': 'String should have at most 1000 characters', 'input': 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa', 'ctx': {'max_length': 1000}}

  File "D:\physical_AI_book_hacka\backend\app\routers\chat.py", line 18, in chat
    POST /api/v1/chat/
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://testserver/api/v1/chat/ "HTTP/1.1 422 Unprocessable Entity"
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - HTTP Exception: 405 - Method Not Allowed
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://testserver/api/v1/chat/conversations/test-123 "HTTP/1.1 405 Method Not Allowed"
2025-12-08 08:15:36 | WARNING  | logging:callHandlers:1762 - Validation error at POST http://testserver/api/v1/chat/feedback: 2 validation errors:
  {'type': 'missing', 'loc': ('query', 'conversation_id'), 'msg': 'Field required', 'input': None}
  {'type': 'missing', 'loc': ('query', 'message_id'), 'msg': 'Field required', 'input': None}

  File "D:\physical_AI_book_hacka\backend\app\routers\chat.py", line 140, in submit_feedback
    POST /api/v1/chat/feedback
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://testserver/api/v1/chat/feedback "HTTP/1.1 422 Unprocessable Entity"
2025-12-08 08:15:36 | WARNING  | logging:callHandlers:1762 - Validation error at POST http://testserver/api/v1/chat/feedback: 2 validation errors:
  {'type': 'missing', 'loc': ('query', 'conversation_id'), 'msg': 'Field required', 'input': None}
  {'type': 'missing', 'loc': ('query', 'message_id'), 'msg': 'Field required', 'input': None}

  File "D:\physical_AI_book_hacka\backend\app\routers\chat.py", line 140, in submit_feedback
    POST /api/v1/chat/feedback
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://testserver/api/v1/chat/feedback "HTTP/1.1 422 Unprocessable Entity"
2025-12-08 08:15:36 | WARNING  | logging:callHandlers:1762 - Validation error at POST http://testserver/api/v1/chat/feedback: 2 validation errors:
  {'type': 'missing', 'loc': ('query', 'conversation_id'), 'msg': 'Field required', 'input': None}
  {'type': 'missing', 'loc': ('query', 'message_id'), 'msg': 'Field required', 'input': None}

  File "D:\physical_AI_book_hacka\backend\app\routers\chat.py", line 140, in submit_feedback
    POST /api/v1/chat/feedback
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://testserver/api/v1/chat/feedback "HTTP/1.1 422 Unprocessable Entity"
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://testserver/api/v1/content/chapters "HTTP/1.1 200 OK"
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - HTTP Exception: 404 - Chapter 1 not found
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://testserver/api/v1/content/chapters/1 "HTTP/1.1 404 Not Found"
2025-12-08 08:15:36 | WARNING  | logging:callHandlers:1762 - Validation error at GET http://testserver/api/v1/content/chapters/99: 1 validation error:
  {'type': 'less_than_equal', 'loc': ('path', 'chapter_number'), 'msg': 'Input should be less than or equal to 4', 'input': '99', 'ctx': {'le': 4}}

  File "D:\physical_AI_book_hacka\backend\app\routers\content.py", line 71, in get_chapter
    GET /api/v1/content/chapters/{chapter_number}
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://testserver/api/v1/content/chapters/99 "HTTP/1.1 422 Unprocessable Entity"
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - HTTP Exception: 404 - Lesson 1-1 not found
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://testserver/api/v1/content/lessons/1/1 "HTTP/1.1 404 Not Found"
2025-12-08 08:15:36 | WARNING  | logging:callHandlers:1762 - Validation error at GET http://testserver/api/v1/content/lessons/99/1: 1 validation error:
  {'type': 'less_than_equal', 'loc': ('path', 'chapter_number'), 'msg': 'Input should be less than or equal to 4', 'input': '99', 'ctx': {'le': 4}}

  File "D:\physical_AI_book_hacka\backend\app\routers\content.py", line 126, in get_lesson
    GET /api/v1/content/lessons/{chapter_number}/{lesson_number}
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://testserver/api/v1/content/lessons/99/1 "HTTP/1.1 422 Unprocessable Entity"
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://testserver/api/v1/content/search?query=Physical%20AI "HTTP/1.1 200 OK"
2025-12-08 08:15:36 | WARNING  | logging:callHandlers:1762 - Validation error at GET http://testserver/api/v1/content/search?query=: 1 validation error:
  {'type': 'string_too_short', 'loc': ('query', 'query'), 'msg': 'String should have at least 2 characters', 'input': '', 'ctx': {'min_length': 2}}

  File "D:\physical_AI_book_hacka\backend\app\routers\content.py", line 212, in search_content
    GET /api/v1/content/search
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://testserver/api/v1/content/search?query= "HTTP/1.1 422 Unprocessable Entity"
2025-12-08 08:15:36 | WARNING  | logging:callHandlers:1762 - Validation error at GET http://testserver/api/v1/content/search?query=a: 1 validation error:
  {'type': 'string_too_short', 'loc': ('query', 'query'), 'msg': 'String should have at least 2 characters', 'input': 'a', 'ctx': {'min_length': 2}}

  File "D:\physical_AI_book_hacka\backend\app\routers\content.py", line 212, in search_content
    GET /api/v1/content/search
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://testserver/api/v1/content/search?query=a "HTTP/1.1 422 Unprocessable Entity"
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://testserver/api/v1/content/navigation "HTTP/1.1 200 OK"
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://testserver/api/v1/content/progress/user123 "HTTP/1.1 200 OK"
2025-12-08 08:15:36 | INFO     | logging:callHandlers:1762 - Starting content indexing for collection: textbook_content
2025-12-08 08:15:37 | INFO     | logging:callHandlers:1762 - HTTP Request: GET https://cfc968b3-733f-49f0-810f-7dcfd76c4caa.us-east4-0.gcp.cloud.qdrant.io:6333/collections "HTTP/1.1 403 Forbidden"
2025-12-08 08:15:37 | ERROR    | logging:callHandlers:1762 - Error creating collection textbook_content: Unexpected Response: 403 (Forbidden)
Raw response content:
b'{"error":"forbidden"}'
2025-12-08 08:15:37 | ERROR    | logging:callHandlers:1762 - Indexing error: Unexpected Response: 403 (Forbidden)
Raw response content:
b'{"error":"forbidden"}'
2025-12-08 08:15:37 | INFO     | logging:callHandlers:1762 - HTTP Exception: 500 - Unexpected Response: 403 (Forbidden)
Raw response content:
b'{"error":"forbidden"}'
2025-12-08 08:15:37 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://testserver/api/v1/embeddings/index/content "HTTP/1.1 500 Internal Server Error"
2025-12-08 08:15:37 | ERROR    | logging:callHandlers:1762 - Search error: 'PhysicalAIChatbot' object has no attribute 'openai'
2025-12-08 08:15:37 | INFO     | logging:callHandlers:1762 - HTTP Exception: 500 - 'PhysicalAIChatbot' object has no attribute 'openai'
2025-12-08 08:15:37 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://testserver/api/v1/embeddings/search?query=Physical%20AI "HTTP/1.1 500 Internal Server Error"
2025-12-08 08:15:37 | ERROR    | logging:callHandlers:1762 - Suggestion error: 'PhysicalAIChatbot' object has no attribute 'openai'
2025-12-08 08:15:37 | INFO     | logging:callHandlers:1762 - HTTP Exception: 500 - 'PhysicalAIChatbot' object has no attribute 'openai'
2025-12-08 08:15:37 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://testserver/api/v1/embeddings/suggest?lesson_id=1&limit=3 "HTTP/1.1 500 Internal Server Error"
2025-12-08 08:15:37 | ERROR    | logging:callHandlers:1762 - Upload error: 'PhysicalAIChatbot' object has no attribute 'openai'
2025-12-08 08:15:37 | INFO     | logging:callHandlers:1762 - HTTP Exception: 500 - 'PhysicalAIChatbot' object has no attribute 'openai'
2025-12-08 08:15:37 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://testserver/api/v1/embeddings/upload "HTTP/1.1 500 Internal Server Error"
2025-12-08 08:15:38 | INFO     | logging:callHandlers:1762 - HTTP Exception: 400 - Only MDX files are supported
2025-12-08 08:15:38 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://testserver/api/v1/embeddings/upload "HTTP/1.1 400 Bad Request"
2025-12-08 08:15:38 | INFO     | logging:callHandlers:1762 - HTTP Request: DELETE https://cfc968b3-733f-49f0-810f-7dcfd76c4caa.us-east4-0.gcp.cloud.qdrant.io:6333/collections/test_collection "HTTP/1.1 403 Forbidden"
2025-12-08 08:15:38 | ERROR    | logging:callHandlers:1762 - Error deleting collection test_collection: Unexpected Response: 403 (Forbidden)
Raw response content:
b'{"error":"forbidden"}'
2025-12-08 08:15:38 | ERROR    | logging:callHandlers:1762 - Collection deletion error: Unexpected Response: 403 (Forbidden)
Raw response content:
b'{"error":"forbidden"}'
2025-12-08 08:15:38 | INFO     | logging:callHandlers:1762 - HTTP Exception: 500 - Unexpected Response: 403 (Forbidden)
Raw response content:
b'{"error":"forbidden"}'
2025-12-08 08:15:38 | INFO     | logging:callHandlers:1762 - HTTP Request: DELETE http://testserver/api/v1/embeddings/collection/test_collection "HTTP/1.1 500 Internal Server Error"
2025-12-08 08:15:38 | INFO     | logging:callHandlers:1762 - HTTP Request: GET https://cfc968b3-733f-49f0-810f-7dcfd76c4caa.us-east4-0.gcp.cloud.qdrant.io:6333/collections "HTTP/1.1 403 Forbidden"
2025-12-08 08:15:38 | ERROR    | logging:callHandlers:1762 - Error getting collection stats: Unexpected Response: 403 (Forbidden)
Raw response content:
b'{"error":"forbidden"}'
2025-12-08 08:15:38 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://testserver/api/v1/embeddings/collections/stats "HTTP/1.1 200 OK"
2025-12-08 08:15:38 | INFO     | logging:callHandlers:1762 - Cache cleared
2025-12-08 08:15:39 | INFO     | logging:callHandlers:1762 - HTTP Request: POST https://api.cohere.com/v1/embed "HTTP/1.1 400 Bad Request"
2025-12-08 08:15:39 | ERROR    | logging:callHandlers:1762 - Error generating embedding: headers: {'access-control-expose-headers': 'X-Debug-Trace-ID', 'cache-control': 'no-cache, no-store, no-transform, must-revalidate, private, max-age=0', 'content-encoding': 'gzip', 'content-type': 'application/json', 'expires': 'Thu, 01 Jan 1970 00:00:00 GMT', 'pragma': 'no-cache', 'vary': 'Origin,Accept-Encoding', 'x-accel-expires': '0', 'x-debug-trace-id': '92afb02fada86cf9afe3baa02c7dc9c9', 'x-endpoint-monthly-call-limit': '1000', 'x-trial-endpoint-call-limit': '100', 'x-trial-endpoint-call-remaining': '98', 'date': 'Mon, 08 Dec 2025 03:15:39 GMT', 'x-envoy-upstream-service-time': '151', 'server': 'envoy', 'via': '1.1 google', 'alt-svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000', 'transfer-encoding': 'chunked'}, status_code: 400, body: {'id': '9bf41fd6-1bf9-438e-b0ba-c619330a5394', 'message': 'invalid request: valid input_type must be provided with the provided model'}
2025-12-08 08:15:41 | INFO     | logging:callHandlers:1762 - HTTP Request: POST https://api.cohere.com/v1/embed "HTTP/1.1 400 Bad Request"
2025-12-08 08:15:41 | ERROR    | logging:callHandlers:1762 - Error generating embedding: headers: {'access-control-expose-headers': 'X-Debug-Trace-ID', 'cache-control': 'no-cache, no-store, no-transform, must-revalidate, private, max-age=0', 'content-encoding': 'gzip', 'content-type': 'application/json', 'expires': 'Thu, 01 Jan 1970 00:00:00 GMT', 'pragma': 'no-cache', 'vary': 'Origin,Accept-Encoding', 'x-accel-expires': '0', 'x-debug-trace-id': '927acac10ed7e41d8901851c8aeb3572', 'x-endpoint-monthly-call-limit': '1000', 'x-trial-endpoint-call-limit': '100', 'x-trial-endpoint-call-remaining': '97', 'date': 'Mon, 08 Dec 2025 03:15:41 GMT', 'x-envoy-upstream-service-time': '14', 'server': 'envoy', 'via': '1.1 google', 'alt-svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000', 'transfer-encoding': 'chunked'}, status_code: 400, body: {'id': 'ff530a50-bf90-489e-b1e9-f5ce22e5f46e', 'message': 'invalid request: valid input_type must be provided with the provided model'}
2025-12-08 08:15:43 | INFO     | logging:callHandlers:1762 - HTTP Request: POST https://api.cohere.com/v1/embed "HTTP/1.1 400 Bad Request"
2025-12-08 08:15:43 | ERROR    | logging:callHandlers:1762 - Error generating embeddings: headers: {'access-control-expose-headers': 'X-Debug-Trace-ID', 'cache-control': 'no-cache, no-store, no-transform, must-revalidate, private, max-age=0', 'content-encoding': 'gzip', 'content-type': 'application/json', 'expires': 'Thu, 01 Jan 1970 00:00:00 GMT', 'pragma': 'no-cache', 'vary': 'Origin,Accept-Encoding', 'x-accel-expires': '0', 'x-debug-trace-id': '7ec2038704edffc906ccd0c0ff1ee60b', 'x-endpoint-monthly-call-limit': '1000', 'x-trial-endpoint-call-limit': '100', 'x-trial-endpoint-call-remaining': '96', 'date': 'Mon, 08 Dec 2025 03:15:43 GMT', 'x-envoy-upstream-service-time': '9', 'server': 'envoy', 'via': '1.1 google', 'alt-svc': 'h3=":443"; ma=2592000,h3-29=":443"; ma=2592000', 'transfer-encoding': 'chunked'}, status_code: 400, body: {'id': '800dda64-b114-42f1-ad91-1c39dce7b843', 'message': 'invalid request: valid input_type must be provided with the provided model'}
2025-12-08 08:15:45 | ERROR    | logging:callHandlers:1762 - Error searching vectors: 'list' object has no attribute 'tolist'
2025-12-08 08:15:45 | ERROR    | logging:callHandlers:1762 - Error retrieving documents: 'list' object has no attribute 'tolist'
2025-12-08 08:15:46 | ERROR    | logging:callHandlers:1762 - Error searching vectors: 'list' object has no attribute 'tolist'
2025-12-08 08:15:46 | ERROR    | logging:callHandlers:1762 - Error retrieving documents: 'list' object has no attribute 'tolist'
2025-12-08 08:15:48 | INFO     | logging:callHandlers:1762 - Extracting text from: https://example.com
2025-12-08 08:15:48 | ERROR    | logging:callHandlers:1762 - parsed tree length: 0, wrong data type or not valid HTML
2025-12-08 08:15:48 | ERROR    | logging:callHandlers:1762 - empty HTML tree: None
2025-12-08 08:15:48 | WARNING  | logging:callHandlers:1762 - discarding data: None
2025-12-08 08:15:48 | ERROR    | logging:callHandlers:1762 - Error extracting text from https://example.com: module 'trafilatura' has no attribute 'extract_title'
2025-12-08 08:15:49 | INFO     | logging:callHandlers:1762 - Extracting text from: https://example.com
2025-12-08 08:15:50 | ERROR    | logging:callHandlers:1762 - parsed tree length: 0, wrong data type or not valid HTML
2025-12-08 08:15:50 | ERROR    | logging:callHandlers:1762 - empty HTML tree: None
2025-12-08 08:15:50 | WARNING  | logging:callHandlers:1762 - discarding data: None
2025-12-08 08:15:50 | ERROR    | logging:callHandlers:1762 - Error extracting text from https://example.com: module 'trafilatura' has no attribute 'extract_title'
2025-12-08 08:15:51 | INFO     | logging:callHandlers:1762 - Created 3 chunks from text (2500 chars)
2025-12-08 08:15:52 | INFO     | logging:callHandlers:1762 - Extracting text from: https://example.com
2025-12-08 08:15:52 | ERROR    | logging:callHandlers:1762 - parsed tree length: 0, wrong data type or not valid HTML
2025-12-08 08:15:52 | ERROR    | logging:callHandlers:1762 - empty HTML tree: None
2025-12-08 08:15:52 | WARNING  | logging:callHandlers:1762 - discarding data: None
2025-12-08 08:15:52 | ERROR    | logging:callHandlers:1762 - Error extracting text from https://example.com: module 'trafilatura' has no attribute 'extract_title'
2025-12-08 08:21:16 | INFO     | logging:callHandlers:1762 - Starting up Physical AI Textbook API...
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - BEGIN (implicit)
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - PRAGMA main.table_info("users")
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - [raw sql] ()
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - PRAGMA temp.table_info("users")
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - [raw sql] ()
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - PRAGMA main.table_info("chat_sessions")
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - [raw sql] ()
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - PRAGMA temp.table_info("chat_sessions")
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - [raw sql] ()
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - PRAGMA main.table_info("chat_messages")
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - [raw sql] ()
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - PRAGMA temp.table_info("chat_messages")
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - [raw sql] ()
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - 
CREATE TABLE users (
	id VARCHAR NOT NULL, 
	email VARCHAR NOT NULL, 
	education VARCHAR, 
	created_at DATETIME DEFAULT (CURRENT_TIMESTAMP), 
	last_active DATETIME DEFAULT (CURRENT_TIMESTAMP), 
	is_active BOOLEAN, 
	preferences JSON, 
	background JSON, 
	hardware JSON, 
	PRIMARY KEY (id)
)


2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - [no key 0.00047s] ()
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - CREATE INDEX ix_users_id ON users (id)
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - [no key 0.00039s] ()
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - CREATE UNIQUE INDEX ix_users_email ON users (email)
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - [no key 0.00043s] ()
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - 
CREATE TABLE chat_sessions (
	id VARCHAR NOT NULL, 
	user_id VARCHAR, 
	lesson_context VARCHAR, 
	created_at DATETIME DEFAULT (CURRENT_TIMESTAMP), 
	updated_at DATETIME DEFAULT (CURRENT_TIMESTAMP), 
	is_active BOOLEAN, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - [no key 0.00049s] ()
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - CREATE INDEX ix_chat_sessions_user_id ON chat_sessions (user_id)
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - [no key 0.00034s] ()
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - CREATE INDEX ix_chat_sessions_id ON chat_sessions (id)
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - [no key 0.00031s] ()
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - 
CREATE TABLE chat_messages (
	id VARCHAR NOT NULL, 
	session_id VARCHAR NOT NULL, 
	role VARCHAR NOT NULL, 
	content TEXT NOT NULL, 
	timestamp DATETIME DEFAULT (CURRENT_TIMESTAMP), 
	sources JSON, 
	related_lessons JSON, 
	feedback JSON, 
	feedback_rating INTEGER, 
	PRIMARY KEY (id), 
	FOREIGN KEY(session_id) REFERENCES chat_sessions (id)
)


2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - [no key 0.00062s] ()
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - CREATE INDEX ix_chat_messages_id ON chat_messages (id)
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - [no key 0.00048s] ()
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - CREATE INDEX ix_chat_messages_session_id ON chat_messages (session_id)
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - [no key 0.00033s] ()
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - Database tables created successfully
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - COMMIT
2025-12-08 08:21:17 | INFO     | logging:callHandlers:1762 - Database initialized
2025-12-08 08:31:31 | INFO     | logging:callHandlers:1762 - HTTP Exception: 404 - Not Found
